!function(a){function n(){window.ajaxrunning||(window.ajaxrunning=!0,a.ajax({url:ajaxurl,data:{action:"output_single_convert_link"},type:"POST",success:function(n){a(".settings").append(n),window.ajaxrunning=!1}}))}a(document).ready(function(){window.ajaxrunning=!1,a("select").selectric(),a("body").hasClass("post-type-attachment")&&(a(document).on("DOMSubtreeModified",".media-frame-content",function(){0===a(".convert-image-setting").length&&n()}),a(document).on("click",".attachment",function(){0===a(".convert-image-setting").length&&n()})),a(document).on("click","#swi-convert-single-image",function(n){var t;n.preventDefault(),t=new URLSearchParams(window.location.search).get("item"),a.ajax({url:ajaxurl,data:{action:"convert_single_attachment",attachment_id:t},type:"POST",success:function(n){"Success!"===n&&a("#swi-convert-single-image").text("Converted!")}})}),a(document).on("click","#start-bulk-conversion",function(n){n.preventDefault(),a("#start-bulk-conversion").slideUp(),a(".step-2").slideDown(),a.ajax({type:"POST",url:ajaxurl,data:{action:"get_total_images"},success:function(n){a(".step-2").slideUp();var t=n;isNaN(t)&&(t=a(n).text()),a("#total-images").text(t),a(".step-3").slideDown(),window.bulkConvertRunning=!1,window.bulkConvertPage=1,setInterval(function(){!1===window.bulkConvertRunning&&(window.bulkConvertRunning=!0,a.ajax({type:"POST",url:ajaxurl,data:{action:"bulk_convert_images",paged:window.bulkConvertPage},success:function(n){if("All done"==n||a(n).text().includes("All done"))return a(".converting").slideUp(),a(".step-4").slideDown(),!1;var t=parseInt(a("#total-images").text()),e=n;isNaN(e)&&(e=a(n).text()),parseInt(e)>t&&(e=t),"All done"!=e&&a("#remaining-images").text(e),window.bulkConvertRunning=!1,window.bulkConvertPage=parseInt(window.bulkConvertPage)+1}}))},100)}})})})}(jQuery);